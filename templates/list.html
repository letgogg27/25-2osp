{% extends "index.html" %} {% block title %}상품 목록{% endblock %}
<!-- {% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
{% endblock %}  -->
{% block content %}
<h2 class="page-title">Ewha Market</h2>
<div class="search-bar">
  <form class="search-form" method="GET" action="/list">
    <input type="text" name="q" placeholder="판매자명 또는 상품명 검색" />
    <select name="sort">
      <option value="">정렬 없음</option>
      <option value="price_asc">가격 낮은 순</option>
      <option value="price_desc">가격 높은 순</option>
    </select>
    <button type="submit">검색</button>
  </form>
</div>

<div class="item-grid">
  {% for p in products %}
  <a class="item-card" href="{{ url_for('item_detail') }}">
    <img
      src="{{ url_for('static', filename='images/icons/' + p.img) }}"
      alt="{{ p.name }}"
      onerror="this.src='/static/images/placeholder.png'"
    />z
    <div class="item-info">
      <h3>{{ p.name }}</h3>
      <p>{{ "{:,}".format(p.price) }}원</p>
      <p>{{ p.location }}</p>
    </div>
    <span class="like-btn">♡</span>
  </a>
  {% endfor %}
</div>

<div class="pagination">
  <!-- 맨 처음 페이지로 이동 -->
  {% if page > 1 %}
  <a href="{{ url_for('product_list') }}?page=1" class="page-ctrl">«</a>
  {% else %}
  <span class="page-ctrl disabled">«</span>
  {% endif %}

  <!-- 페이지 번호 -->
  {% for i in range(1, total_pages+1) %}
    {% if i == page %}
      <span class="page active">{{ i }}</span>
    {% else %}
      <a href="{{ url_for('product_list') }}?page={{ i }}" class="page">{{ i }}</a>
    {% endif %}
  {% endfor %}

  <!-- 마지막 페이지로 이동 -->
  {% if page < total_pages %}
  <a href="{{ url_for('product_list') }}?page={{ total_pages }}" class="page-ctrl">»</a>
  {% else %}
  <span class="page-ctrl disabled">»</span>
  {% endif %}
</div>

{% endblock %}
